{% extends "base.twig" %}

{% block title_text %}Demo de carte autonome{% endblock %}

{% block navbar_title_text %}Carte des centres{% endblock %}

{% block navbar_links %}
<li class="active"><a href="{{BASE_URL}}">Carte</a></li>
<li><a href="{{BASE_URL}}about/">A propos</a></li>
<li><a href="{{BASE_URL}}contact/">Contact</a></li>
{% endblock %}

{% block ng_app_name %}standalonemap{% endblock %}

{% block container %}
    <div class="row">
        <div class="col-md-8">
            
            <h2 class="floatleft correctmargins">Projets pour l&#39;ann&eacute;e: </h2>
            
            <div class="panel-body floatleft">
                <ol id="track_by_examples" class="nya-bs-select" ng-model="year_selected" title="Toutes les ann&eacute;es" ng-change="year_selection_changed(year_selected)">
                    <li nya-bs-option="year in json_years track by year.PR_Annee" ng-switch="year.PR_Annee">                        
                        <a ng-switch-when="0">
                            Non d&eacute;fini ({[{year.PS_Nb_Ps}]} projets)
                        </a>
                        <a ng-switch-default="0">
                            <strong>{[{year.PR_Annee}]}</strong> ({[{year.PS_Nb_Ps}]} projets)
                        </a>
                    </li>
                </ol>
            </div>
            </div>
    </div>
    <div class="row">
        <div class="col-md-12">            
            <openlayers lat="45.76" lon="10.8400" zoom="6" custom-layers="true" ol-defaults="defaults">
                <!--declare the tile layer. HERE REPLACE THE SOURCE-URL by something meaningful -->
                <ol-layer ol-layer-properties="tiles"></ol-layer>
                <ol-layer ol-layer-properties="markers"></ol-layer>
            </openlayers>
        </div>
        
    </div>
{% endblock %}
{% block sidebar %}
    <div class="sidebar-nav">
        <!--Notice the ng-if conditional expression -->
        <h2 ng-if="cur_marker">{[{cur_marker.PS_Nom}]}</h2>
        <h2 ng-if="!cur_marker">Sans nom</h2>
        <div class="marker_related">
            <h4 ng-if="cur_marker.trs.length">Transformateurs pour ce poste:</h4>
            <h4 ng-if="!cur_marker.trs.length && !cur_marker.draft" class="no_items">Aucun transformateur pour ce poste</h4>
            <ul ng-if="cur_marker.trs.length" class="trs">
                <li ng-repeat="tr in cur_marker.trs track by tr.idgpc_tr">{[{tr.TR_No}]} <span ng-if="tr.TR_Puissance">({[{tr.TR_Puissance}]})</span></li>
            </ul>
            <h4 ng-if="cur_marker.projects.length">Projets pour ce poste:</h4>
            <h4 ng-if="!cur_marker.projects.length && !cur_marker.draft" class="no_items">Aucun projet pour ce poste</h4>
            <h4 ng-if="cur_marker.draft">Chargement...</h4>
            <ul ng-if="cur_marker.projects.length" class="projects_list">
                <li ng-repeat="project in cur_marker.projects track by project.idgpc_projets">{[{project.PR_Libelle}]}</li>
            </ul>
            <div ng-if="debug">
                Commentaires: {[{cur_marker.PS_Commentaire}]}
            </div>
        </div>
    </div>
{% endblock %}
{% block copyright_text %}Labscinet 2015{% endblock %}


{% block inclusions_js_3rdparty %}
<script src="{{STATIC_URL}}dist/underscore/underscore-min.js"></script>
<script src="{{STATIC_URL}}dist/jquery/jquery-1.11.2.min.js"></script>
<script src="{{STATIC_URL}}dist/angular/angular.min.js"></script>
<script src="{{STATIC_URL}}dist/angular/angular-sanitize.min.js"></script>
<script src="{{STATIC_URL}}dist/bootstrap/js/bootstrap.min.js"></script>
<script src="{{STATIC_URL}}dist/openlayers/ol.js"></script>
<script src="{{STATIC_URL}}dist/ol3-popup/ol3-popup.js"></script>
<script src="{{STATIC_URL}}dist/underscore.string/underscore.string.min.js"></script>

<script src="{{STATIC_URL}}dist/angular-openlayers-directive/angular-openlayers-directive.js"></script>


<script src="{{STATIC_URL}}dist/nya-bootstrap-select/nya-bs-select.js"></script>

{% endblock %}
{% block inclusions_js_custom %}
<script type="text/ng-template" id="popup.html">
<div>
  <a ng-href='#' ng-click='show_marker_details("map")'>{[{cur_marker.PS_Nom}]}</a>
</div>
</script>


<script src="{{STATIC_URL}}map.js"></script>
{% endblock %}
